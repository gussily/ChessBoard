(this["webpackJsonpchess-app"]=this["webpackJsonpchess-app"]||[]).push([[0],{18:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r=n(2),i=n(5),a=n(4),c=n(0),s=n(3),u=n(7),o=n.n(u),l=n(12),h=n.n(l),v=(n(18),n(13)),p=n(6),y=n(9),f="\u2654",d="Q",P="R",g="B",k="N",O="P",b="";function m(e){return e==R.PLAYER_1?R.PLAYER_2:e==R.PLAYER_2?R.PLAYER_1:void 0}var R={PLAYER_1:"white",PLAYER_2:"black",NONE:"empty"},j=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(c.a)(this,e),this.pieces=this.genPieces(t),this.pieceList=t,this.selectedPiece=n,this.handleCastled(r)}return Object(r.a)(e,[{key:"copy",value:function(){R.PLAYER_1,R.PLAYER_2;return new e(this.pieceList.map((function(e){return e.copy()})),this.selectedPiece,{player1:this.castled.player1,player2:this.castled.player2})}},{key:"handleCastled",value:function(e){if(e)this.castled=e;else{R.PLAYER_1,R.PLAYER_2;this.castled={player1:!1,player2:!1}}}},{key:"playerCanMove",value:function(e){var t=this,n=this.getPiecesFromPlayer(e);return(n=n.filter((function(e){return e.hasLegalMove(t)}))).length>0}},{key:"getPiecesFromPlayer",value:function(e){return this.pieceList.filter((function(t){return t.player==e}))}},{key:"getPlayerKing",value:function(e){return this.pieceList.filter((function(t){return t.player==e&&t.pieceRender==f}))[0]}},{key:"genPieces",value:function(e){return Object(s.a)(Array(8).keys()).map((function(t){return Object(s.a)(Array(8).keys()).map((function(n){return e[8*t+n]}))}))}},{key:"getPiece",value:function(e){return this.pieceList[e]}},{key:"getPieceXY",value:function(e,t){return this.getPiece(8*t+e)}},{key:"pieceMove",value:function(e,t){var n=this.copy();return n.updatePiece(t,n.getPiece(e)),n.updatePiece(e,new S(e)),n.handleQueening(t),n}},{key:"handleQueening",value:function(e){var t=this.getPiece(e),n=t.player==R.PLAYER_1?0:7;t.pieceRender==O&&t.y==n&&this.updatePiece(e,new x(t.player,e))}},{key:"updatePiece",value:function(e,t){var n=t.updateLocation(e);this.pieceList[e]=n,this.pieces[~~(e/8)][e%8]=n}},{key:"selectPiece",value:function(e){var t=this.copy();return t.pieceList[e].selected=!0,t.selectedPiece=e,t}},{key:"unselectPiece",value:function(){var e=this.copy();return e.selectedPiece&&(e.pieceList[e.selectedPiece].selected=!1),e}},{key:"kingUnderAttack",value:function(e){var t=this.getPlayerKing(e),n=m(e),r=this.getPiecesFromPlayer(n),i=this.copy();return r.filter((function(e){if(n=e.getMoveOptions(i),r=t.i,-1!==n.indexOf(r))return!0;var n,r})).length>0}}]),e}(),A=function(){function e(t,n,r){var i=this;Object(c.a)(this,e),this.pieceRender=t,this.player=n,this.y=~~(r/8),this.x=r%8,this.i=r,this.moveFilters=[],this.complexMoveFilters=[],this.moveFilters.push((function(e){return e.player!=i.player})),this.setPieceUnicode("",""),this.selected=!1}return Object(r.a)(e,[{key:"copy",value:function(){return new e(this.pieceRender,this.player,this.i)}},{key:"setPieceUnicode",value:function(e,t){this.player==R.PLAYER_1?this.pieceUnicode=e:this.player==R.PLAYER_2?this.pieceUnicode=t:this.pieceUnicode=""}},{key:"getAllLegalMoves",value:function(e){var t=this.getMoveOptions(e),n=this.i,r=this.player;return t.filter((function(t){return!e.pieceMove(n,t).kingUnderAttack(r)}))}},{key:"getMoveOptions",value:function(e){var t,n=this.getRangeOfMotion().map((function(t){return e.getPieceXY(t[0],t[1])})),r=[],i=Object(y.a)(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;this.applyMoveFilters(a)&&this.applyMoveFilters(a,e)&&r.push(a.i)}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"applyMoveFilters",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=n?this.complexMoveFilters:this.moveFilters,i=Object(y.a)(r);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(!a(e,n))return!1}}catch(c){i.e(c)}finally{i.f()}return!0}},{key:"getRangeOfMotion",value:function(){return[]}},{key:"hasLegalMove",value:function(e){return this.getAllLegalMoves(e).length>0}},{key:"isLegalMove",value:function(e,t){return 1==this.getAllLegalMoves(t).filter((function(t){return t==e})).length}},{key:"updateLocation",value:function(e){var t=this.copy();return t.y=~~(e/8),t.x=e%8,t.i=e,t}},{key:"moveIsOnBoard",value:function(e){return e.filter((function(e){return 0<=e[0]&&8>e[0]&&0<=e[1]&&8>e[1]}))}}]),e}(),L=function(e){Object(i.a)(n,e);var t=Object(a.a)(n);function n(e,r){var i;return Object(c.a)(this,n),(i=t.call(this,f,e,r)).setPieceUnicode("\u2654","\u265a"),i}return Object(r.a)(n,[{key:"copy",value:function(){return new n(this.player,this.i)}},{key:"getRangeOfMotion",value:function(){var e=this,t=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]].map((function(t){return[e.x+t[0],e.y+t[1]]}));return this.moveIsOnBoard(t)}},{key:"getAllLegalMoves",value:function(e){var t=Object(v.a)(Object(p.a)(n.prototype),"getAllLegalMoves",this).call(this,e),r=this.checkCastles(e,"kingside"),i=this.checkCastles(e,"queenside");return r&&t.push(r),i&&t.push(i),t}},{key:"checkCastles",value:function(e,t){var n=this.genCastleSquares(t);return e.castled[this.player]?null:this.checkPiecePlacement(e,n)&&this.checkMiddlePieces(e,n)&&this.checkSafeSquares(e,n)?n[2]:null}},{key:"checkSafeSquares",value:function(e,t){var n=t.slice(1,3);console.log("check squares"),console.log(n);var r=this.i,i=this.player,a=e.kingUnderAttack(i),c=n.filter((function(t){return e.pieceMove(r,t).kingUnderAttack(i)}));return!a&&0==c.length}},{key:"checkMiddlePieces",value:function(e,t){return 0==t.slice(1,t.length-1).filter((function(t){return e.getPiece(t).player!=R.NONE})).length}},{key:"checkPiecePlacement",value:function(e,t){var n=e.getPiece(t[t.length-1]),r=e.getPiece(t[0]);return n.pieceRender==P&&n.player==this.player&&r.pieceRender==f&&r.player==this.player}},{key:"genCastleSquares",value:function(e){return"kingside"==e&&this.player==R.PLAYER_2?[4,5,6,7]:"kingside"==e&&this.player==R.PLAYER_1?[60,61,62,63]:"queenside"==e&&this.player==R.PLAYER_2?[4,3,2,1,0]:"queenside"==e&&this.player==R.PLAYER_1?[60,59,58,57,56]:void 0}}]),n}(A),E=function(e){Object(i.a)(n,e);var t=Object(a.a)(n);function n(e,r){var i;return Object(c.a)(this,n),(i=t.call(this,k,e,r)).setPieceUnicode("\u2658","\u265e"),i}return Object(r.a)(n,[{key:"copy",value:function(){return new n(this.player,this.i)}},{key:"getRangeOfMotion",value:function(){var e=this,t=[[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]].map((function(t){return[e.x+t[0],e.y+t[1]]}));return this.moveIsOnBoard(t)}}]),n}(A),Y=function(e){Object(i.a)(n,e);var t=Object(a.a)(n);function n(e,r){var i;return Object(c.a)(this,n),(i=t.call(this,O,e,r)).moveFilters.push(i.checkTaking()),i.complexMoveFilters.push(i.checkMove2()),i.setPieceUnicode("\u2659","\u265f"),i}return Object(r.a)(n,[{key:"copy",value:function(){return new n(this.player,this.i)}},{key:"getRangeOfMotion",value:function(){var e=this,t=[];return t=(t=this.player==R.PLAYER_1?[[0,-1],[0,-2],[-1,-1],[1,-1]]:[[0,1],[0,2],[-1,1],[1,1]]).map((function(t){return[e.x+t[0],e.y+t[1]]})),this.moveIsOnBoard(t)}},{key:"checkTaking",value:function(){var e=this.x,t=this.player;return function(n,r){return 1==Math.abs(n.x-e)?n.player==m(t):n.x==e?n.player==R.NONE:void 0}}},{key:"checkMove2",value:function(){var e=this.y,t=this.x,n=this.player;return function(r,i){if(1==Math.abs(e-r.y))return!0;if(2==Math.abs(e-r.y)){if(n==R.PLAYER_1){var a=i.getPieceXY(t,5);return 6==e&&a.player==R.NONE}if(n==R.PLAYER_2){var c=i.getPieceXY(t,2);return 1==e&&c.player==R.NONE}}}}}]),n}(A),w=function(e){Object(i.a)(n,e);var t=Object(a.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"getMoveOptions",value:function(e){var t,n=[],r=this.getRangeOfMotion(),i=Object(y.a)(r);try{for(i.s();!(t=i.n()).done;){var a=t.value.map((function(t){return e.getPieceXY(t[0],t[1])})),c=this.applyRangeMoveChecker(a);n=n.concat(c)}}catch(s){i.e(s)}finally{i.f()}return n}},{key:"applyRangeMoveChecker",value:function(e){var t,n=[],r=Object(y.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.player==this.player)return n;if(i.player!=R.NONE)return n.push(i.i),n;n.push(i.i)}}catch(a){r.e(a)}finally{r.f()}return n}}]),n}(A),_=function(e){Object(i.a)(n,e);var t=Object(a.a)(n);function n(e,r){var i;return Object(c.a)(this,n),(i=t.call(this,P,e,r)).setPieceUnicode("\u2656","\u265c"),i}return Object(r.a)(n,[{key:"copy",value:function(){return new n(this.player,this.i)}},{key:"getRangeOfMotion",value:function(){var e=this,t=[],n=Object(s.a)(Array(7).keys()).map((function(e){return[0,e+1]})).map((function(t){return[e.x+t[0],e.y+t[1]]})),r=Object(s.a)(Array(7).keys()).map((function(e){return[0,-1-e]})).map((function(t){return[e.x+t[0],e.y+t[1]]})),i=Object(s.a)(Array(7).keys()).map((function(e){return[e+1,0]})).map((function(t){return[e.x+t[0],e.y+t[1]]})),a=Object(s.a)(Array(7).keys()).map((function(e){return[-1-e,0]})).map((function(t){return[e.x+t[0],e.y+t[1]]}));return t.push(this.moveIsOnBoard(n)),t.push(this.moveIsOnBoard(r)),t.push(this.moveIsOnBoard(i)),t.push(this.moveIsOnBoard(a)),t}}]),n}(w),M=function(e){Object(i.a)(n,e);var t=Object(a.a)(n);function n(e,r){var i;return Object(c.a)(this,n),(i=t.call(this,g,e,r)).setPieceUnicode("\u2657","\u265d"),i}return Object(r.a)(n,[{key:"copy",value:function(){return new n(this.player,this.i)}},{key:"getRangeOfMotion",value:function(){var e=this,t=[],n=Object(s.a)(Array(7).keys()).map((function(e){return[e+1,-e-1]})).map((function(t){return[e.x+t[0],e.y+t[1]]})),r=Object(s.a)(Array(7).keys()).map((function(e){return[-e-1,-e-1]})).map((function(t){return[e.x+t[0],e.y+t[1]]})),i=Object(s.a)(Array(7).keys()).map((function(e){return[e+1,e+1]})).map((function(t){return[e.x+t[0],e.y+t[1]]})),a=Object(s.a)(Array(7).keys()).map((function(e){return[-e-1,e+1]})).map((function(t){return[e.x+t[0],e.y+t[1]]}));return t.push(this.moveIsOnBoard(n)),t.push(this.moveIsOnBoard(r)),t.push(this.moveIsOnBoard(i)),t.push(this.moveIsOnBoard(a)),t}}]),n}(w),x=function(e){Object(i.a)(n,e);var t=Object(a.a)(n);function n(e,r){var i;return Object(c.a)(this,n),(i=t.call(this,d,e,r)).setPieceUnicode("\u2655","\u265b"),i}return Object(r.a)(n,[{key:"copy",value:function(){return new n(this.player,this.i)}},{key:"getRangeOfMotion",value:function(){var e=new M(this.player,this.i).getRangeOfMotion(),t=new _(this.player,this.i).getRangeOfMotion();return e.concat(t)}}]),n}(w),S=function(e){Object(i.a)(n,e);var t=Object(a.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,b,R.NONE,e)}return n}(A),N=n(1),q=[new _(R.PLAYER_2,0),new E(R.PLAYER_2,1),new M(R.PLAYER_2,2),new x(R.PLAYER_2,3),new L(R.PLAYER_2,4),new M(R.PLAYER_2,5),new E(R.PLAYER_2,6),new _(R.PLAYER_2,7),new Y(R.PLAYER_2,8),new Y(R.PLAYER_2,9),new Y(R.PLAYER_2,10),new Y(R.PLAYER_2,11),new Y(R.PLAYER_2,12),new Y(R.PLAYER_2,13),new Y(R.PLAYER_2,14),new Y(R.PLAYER_2,15)],C=Object(s.a)(Array(32).keys()).map((function(e){return e+16})).map((function(e){return new S(e)})),U=[new Y(R.PLAYER_1,48),new Y(R.PLAYER_1,49),new Y(R.PLAYER_1,50),new Y(R.PLAYER_1,51),new Y(R.PLAYER_1,52),new Y(R.PLAYER_1,53),new Y(R.PLAYER_1,54),new Y(R.PLAYER_1,55),new _(R.PLAYER_1,56),new E(R.PLAYER_1,57),new M(R.PLAYER_1,58),new x(R.PLAYER_1,59),new L(R.PLAYER_1,60),new M(R.PLAYER_1,61),new E(R.PLAYER_1,62),new _(R.PLAYER_1,63)],T=new j(q.concat(C).concat(U));function B(e){var t="";e.piece.selected&&(t=" selected");var n="lightSquare";Math.floor(e.piece.i/8)%2==e.piece.i%2&&(n="darkSquare");var r=n+" "+t;return Object(N.jsx)("button",{className:r,onClick:e.onClick,children:e.piece.pieceUnicode})}var F=function(e){Object(i.a)(n,e);var t=Object(a.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"renderSquare",value:function(e){var t=this;return Object(N.jsx)(B,{piece:this.props.squares[e],onClick:function(){return t.props.onClick(e)}})}},{key:"renderRow",value:function(e){return Object(N.jsxs)("div",{className:"board-row",children:[this.renderSquare(8*e+0),this.renderSquare(8*e+1),this.renderSquare(8*e+2),this.renderSquare(8*e+3),this.renderSquare(8*e+4),this.renderSquare(8*e+5),this.renderSquare(8*e+6),this.renderSquare(8*e+7)]})}},{key:"render",value:function(){return Object(N.jsxs)("div",{children:[this.renderRow(0),this.renderRow(1),this.renderRow(2),this.renderRow(3),this.renderRow(4),this.renderRow(5),this.renderRow(6),this.renderRow(7)]})}}]),n}(o.a.Component),I=function(e){Object(i.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={history:[{squares:T}],playerTurn:R.PLAYER_1,moveNumber:0,moveStage:"readyToSelect",pieceSelected:null},r}return Object(r.a)(n,[{key:"handleClick",value:function(e){return"readyToSelect"===this.state.moveStage?this.handlePieceSelect(e):this.handlePieceMove(e)}},{key:"handlePieceSelect",value:function(e){var t=this.state.history.slice(0,this.state.moveNumber+1),n=t[this.state.moveNumber].squares.copy(),r=n.getPiece(e);if(this.state.playerTurn===r.player)if(r.hasLegalMove(n.copy())){var i=n.selectPiece(e);t[this.state.moveNumber].squares=i,this.setState({history:t,moveStage:"readyToMove",pieceSelected:r.copy()})}else console.log("no move")}},{key:"handlePieceMove",value:function(e){var t=this.state.history.slice(0,this.state.moveNumber+1),n=t[t.length-1].squares.copy();n.getPiece(e);if(this.state.pieceSelected.isLegalMove(e,n.copy())){var r=n.unselectPiece();t[t.length-1].squares=r;var i=this.state.pieceSelected.copy();n=(n=this.handleKingMove(n,i.i,e)).pieceMove(i.i,e),this.setState({history:t.concat([{squares:n}]),moveStage:"readyToSelect",pieceSelected:null,playerTurn:this.state.playerTurn===R.PLAYER_1?R.PLAYER_2:R.PLAYER_1,moveNumber:t.length})}else console.log("fire")}},{key:"handleKingMove",value:function(e,t,n){var r=e.getPiece(t),i=e.getPiece(n);if(r.pieceRender==f){if(console.log("a"),2==Math.abs(r.x-i.x)){var a;if(r.x>i.x){var c=i.i-2;(a=e.pieceMove(c,c+3)).castled[r.player]=!0}else if(r.x<i.x){var s=i.i+1;console.log("rooki"),console.log(s),(a=e.pieceMove(s,s-2)).castled[r.player]=!0}return a}var u=e.copy();return u.castled[r.player]=!0,u}return e}},{key:"jumpTo",value:function(e){this.setState({moveNumber:e,moveStage:"readyToSelect",pieceSelected:null,playerTurn:e%2==0?R.PLAYER_1:R.PLAYER_2})}},{key:"render",value:function(){var e,t=this,n=this.state.history,r=n[this.state.moveNumber],i=function(e,t){var n=t.kingUnderAttack(e),r=t.playerCanMove(e);return!r&&n?m(e):r?null:R.NONE}(this.state.playerTurn,r.squares),a=n.map((function(e,n){var r=n?"Go to move #"+n:"Go to game start";return Object(N.jsx)("li",{children:Object(N.jsxs)("button",{onClick:function(){return t.jumpTo(n)},children:[" ",r]})},n)}));return e=i?i==R.NONE?"Stalemate":"Winner: "+i:(this.state.playerTurn==R.PLAYER_1?"White":"Black")+"'s turn",Object(N.jsxs)("div",{className:"game",children:[Object(N.jsx)("div",{className:"game-board",children:Object(N.jsx)(F,{squares:r.squares.pieceList,onClick:function(e){return t.handleClick(e)}})}),Object(N.jsxs)("div",{className:"game-info",children:[Object(N.jsx)("div",{children:e}),Object(N.jsx)("ol",{children:a})]})]})}}]),n}(o.a.Component);h.a.render(Object(N.jsx)(I,{}),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.c8868c63.chunk.js.map